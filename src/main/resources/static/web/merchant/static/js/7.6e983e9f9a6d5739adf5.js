webpackJsonp([7],{"5V2a":function(e,t,r){"use strict";t.d=function(){return Object(a.a)({url:"/member/credits_ruler/find",method:"get",params:{}})},t.i=function(e){return Object(a.a)({url:"/member/credits_ruler/update",method:"post",data:s.a.stringify(e)})},t.g=function(e,t){return Object(a.a)({url:"/member/credits_product/update",method:"post",data:s.a.stringify({productNums:t,id:e})})},t.f=function(e,t,r){return Object(a.a)({url:"/member/credits_product/list_re",method:"get",params:{pageNumber:e,pageSize:t,productName:r.productName,status:r.status}})},t.b=function(e){return Object(a.a)({url:"/member/credits_product/delete",method:"post",data:s.a.stringify({ids:e})})},t.h=function(e){return Object(a.a)({url:"/member/credits_product/update",method:"post",data:s.a.stringify({id:e,interrupt:1,status:2})})},t.e=function(e,t,r){return Object(a.a)({url:"/member/change_record/list_re",method:"get",params:{pageNumber:e,pageSize:t,phone:r.phone,start_exchangeTime:r.start_exchangeTime,end_exchangeTime:r.end_exchangeTime}})},t.c=function(e){return Object(a.a)({url:"/member/credits_product/search",method:"get",params:{id:e}})},t.a=function(e){return Object(a.a)({url:"/member/credits_product/save_re",method:"post",data:s.a.stringify({exchangeStart:e.exchangeStart,exchangeEnd:e.exchangeEnd,exchangeMessage:e.exchangeMessage,credits:e.credits,productName:e.productName,productMoney:e.productMoney,imgUrl:e.imgUrl,productNums:e.productNums,isLimited:e.isLimited,limitedNum:e.limitedNum,status:0,interrupt:0})})};var a=r("vLgD"),i=r("mw3O"),s=r.n(i)},UjeV:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r("5V2a"),i=r("FG0f"),s={name:"pointGoodsAdd",data:function(){var e=this;return{loading:!1,btnLoading:!1,id:"",formwidth:"width: 403px",itemForm:{exchangeStart:"",exchangeEnd:"",exchangeMessage:"",productName:"",imgUrl:"",isLimited:1,limitedNum:1,status:0,interrupt:0},itemImageURL:"",rules:{exchangeStart:[{required:!0,message:"请选择开始时间",trigger:"blur"}],exchangeEnd:[{required:!0,message:"请选择结束时间",trigger:"blur"}],credits:[{required:!0,message:"请输入所需积分"}],productName:[{required:!0,message:"请输入商品名称",trigger:"blur"}],productMoney:[{required:!0,message:"请输入商品价格"}],imgUrl:[{required:!0,message:"还未上传图片"}],productNums:[{required:!0,message:"请输入商品数量"}],limitedNum:[{validator:function(t,r,a){console.log(e.itemForm.isLimited),console.log(r),1==e.itemForm.isLimited?""==r?a(new Error("请填写")):0==r?a(new Error("不能为0")):a():a()},trigger:"blur"}]},filesData:{module:"image"},url:i.c+"/user",headers:{authorized:sessionStorage.token}}},methods:{successSubmitImage:function(e,t){console.log(e),this.$message({message:"图片上传成功！",type:"success"}),this.itemForm.imgUrl=e.obj,this.itemImageURL=Object(i.b)(e.obj)},failedSubmitImage:function(){this.$message({message:"图片上传失败",type:"error"})},checkImage:function(e){return!("image"!==e.type.substring(0,5))||(this.$message.error("只允许图片格式（jpg / jpeg / png）"),!1)},submitItem:function(){var e=this,t=this;console.log(this.itemForm),this.$refs.itemForm.validate(function(r){if(!r)return e.btnLoading=!1,e.$message.error("还有未填写的内容"),!1;e.btnLoading=!0;var i=e.itemForm,s={exchangeStart:e.format(i.exchangeStart),exchangeEnd:e.format(i.exchangeEnd),exchangeMessage:i.exchangeMessage,credits:i.credits,productName:i.productName,productMoney:i.productMoney,imgUrl:i.imgUrl,productNums:i.productNums,isLimited:i.isLimited,limitedNum:i.limitedNum,status:0,interrupt:0,exchangeNum:0};Object(a.a)(s).then(function(r){e.$message.success("添加成功"),e.btnLoading=!1,setTimeout(function(){t.goBack()},1e3)}).catch(function(t){e.btnLoading=!1,e.$message.error("添加失败"+t)})})},dayCheck:function(){var e=this.itemForm;e.exchangeStart>e.exchangeEnd&&""!=e.exchangeEnd&&(this.itemForm.exchangeStart=e.exchangeEnd-864e5,this.$message("开始日期不能晚于结束日期,已设置默认开始时间"))},goBack:function(){this.$router.go("-1")},format:function(e){if(""==e)return"";var t=new Date(e),r=t.getFullYear(),a=t.getMonth()+1,i=t.getDate();return r+"-"+this.add0(a)+"-"+this.add0(i)},add0:function(e){return e<10?"0"+e:e}}},o={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"app-container"},[r("el-form",{ref:"itemForm",staticClass:"demo-ruleForm",attrs:{model:e.itemForm,rules:e.rules,"label-width":"180px"}},[r("el-card",{staticClass:"box-card"},[r("div",{staticClass:"clearfix",staticStyle:{height:"20px",padding:"0"},attrs:{slot:"header"},slot:"header"},[r("span",[e._v("创建活动")]),e._v(" "),r("el-button",{staticStyle:{float:"right",height:"20px",margin:"0",padding:"0"},attrs:{type:"text",size:"small"},on:{click:e.goBack}},[e._v("返回")])],1),e._v(" "),r("div",[r("el-card",{staticClass:"box-card",attrs:{shadow:"hover"}},[r("div",{staticClass:"clearfix",staticStyle:{height:"20px",padding:"0"},attrs:{slot:"header"},slot:"header"},[r("span",[e._v("基本信息")])]),e._v(" "),r("el-form-item",{attrs:{label:"兑换时间",required:""}},[r("el-form-item",{staticClass:"block",attrs:{prop:"exchangeStart"}},[r("el-date-picker",{staticStyle:{width:"190px"},attrs:{type:"date",placeholder:"开始日期",format:"yyyy 年 MM 月 dd 日","value-format":"timestamp"},on:{change:e.dayCheck},model:{value:e.itemForm.exchangeStart,callback:function(t){e.$set(e.itemForm,"exchangeStart",t)},expression:"itemForm.exchangeStart"}})],1),e._v(" "),r("span",[e._v("--")]),e._v(" "),r("el-form-item",{staticClass:"block",attrs:{prop:"exchangeEnd"}},[r("el-date-picker",{staticStyle:{width:"190px"},attrs:{type:"date",placeholder:"结束日期",format:"yyyy 年 MM 月 dd 日","value-format":"timestamp"},on:{change:e.dayCheck},model:{value:e.itemForm.exchangeEnd,callback:function(t){e.$set(e.itemForm,"exchangeEnd",t)},expression:"itemForm.exchangeEnd"}})],1)],1),e._v(" "),r("el-form-item",{attrs:{label:"兑换说明"}},[r("el-input",{style:e.formwidth,attrs:{type:"textarea",rows:6,placeholder:"请输入兑换说明","show-word-limit":"",maxlength:"200"},model:{value:e.itemForm.exchangeMessage,callback:function(t){e.$set(e.itemForm,"exchangeMessage",t)},expression:"itemForm.exchangeMessage"}})],1)],1)],1),e._v(" "),r("div",{staticStyle:{"margin-top":"20px"}},[r("el-card",{staticClass:"box-card",attrs:{shadow:"hover"}},[r("div",{staticClass:"clearfix",staticStyle:{height:"20px",padding:"0"},attrs:{slot:"header"},slot:"header"},[r("span",[e._v("规则配置")])]),e._v(" "),r("el-form-item",{attrs:{label:"兑换所需积分",prop:"credits"}},[r("el-input-number",{style:e.formwidth,attrs:{precision:0,min:1,max:999999},model:{value:e.itemForm.credits,callback:function(t){e.$set(e.itemForm,"credits",t)},expression:"itemForm.credits"}}),e._v("\n            积分\n          ")],1),e._v(" "),r("el-form-item",{attrs:{label:"商品名称",prop:"productName"}},[r("el-input",{style:e.formwidth,attrs:{placeholder:"商品名称"},model:{value:e.itemForm.productName,callback:function(t){e.$set(e.itemForm,"productName",t)},expression:"itemForm.productName"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"商品价格",prop:"productMoney"}},[r("el-input-number",{style:e.formwidth,attrs:{precision:0,min:1,max:999999},model:{value:e.itemForm.productMoney,callback:function(t){e.$set(e.itemForm,"productMoney",t)},expression:"itemForm.productMoney"}}),e._v("\n            元\n          ")],1),e._v(" "),r("el-form-item",{attrs:{label:"商品图片",prop:"imgUrl"}},[r("el-upload",{staticClass:"logo-uploader",attrs:{action:e.url,data:e.filesData,name:"files","show-file-list":!1,"on-success":e.successSubmitImage,"on-error":e.failedSubmitImage,"before-upload":e.checkImage,headers:e.headers}},[e.itemImageURL?r("img",{staticClass:"logo",attrs:{src:e.itemImageURL}}):r("i",{staticClass:"el-icon-plus logo-uploader-icon"}),e._v(" "),r("el-input",{staticStyle:{display:"none"},model:{value:e.itemForm.imgUrl,callback:function(t){e.$set(e.itemForm,"imgUrl",t)},expression:"itemForm.imgUrl"}})],1),e._v(" "),r("span",{staticClass:"image_tips"},[e._v("建议比例750*400，支持JPG、PNG格式，大小在1M以内")])],1),e._v(" "),r("el-form-item",{attrs:{label:"商品数量",prop:"productNums"}},[r("el-input-number",{style:e.formwidth,attrs:{precision:0,min:1,max:99999,label:""},model:{value:e.itemForm.productNums,callback:function(t){e.$set(e.itemForm,"productNums",t)},expression:"itemForm.productNums"}}),e._v("\n            件（库存）\n          ")],1),e._v(" "),r("el-form-item",{attrs:{label:"每位用户限兑"}},[r("el-select",{attrs:{placeholder:"请选择"},model:{value:e.itemForm.isLimited,callback:function(t){e.$set(e.itemForm,"isLimited",t)},expression:"itemForm.isLimited"}},[r("el-option",{attrs:{label:"不限制",value:2}}),e._v(" "),r("el-option",{attrs:{label:"设定每人兑换上限",value:1}})],1),e._v("\n             \n            "),"1"==e.itemForm.isLimited?r("el-form-item",{staticClass:"block",attrs:{prop:"limitedNum"}},[r("el-input-number",{attrs:{precision:0,min:1,max:e.itemForm.productNums},model:{value:e.itemForm.limitedNum,callback:function(t){e.$set(e.itemForm,"limitedNum",t)},expression:"itemForm.limitedNum"}}),e._v("\n              件\n            ")],1):e._e()],1)],1)],1),e._v(" "),r("div",{staticClass:"card-btn"},[r("el-button",{directives:[{name:"loading",rawName:"v-loading",value:e.btnLoading,expression:"btnLoading"}],attrs:{type:"primary",size:"small",disabled:e.btnLoading},on:{click:e.submitItem}},[e._v("确认创建活动")]),e._v(" "),r("el-button",{attrs:{type:"",size:"small"},on:{click:e.goBack}},[e._v("取 消")])],1)])],1)],1)},staticRenderFns:[]};var m=r("VU/8")(s,o,!1,function(e){r("pxB5")},"data-v-56300474",null);t.default=m.exports},pxB5:function(e,t){}});
//# sourceMappingURL=7.6e983e9f9a6d5739adf5.js.map